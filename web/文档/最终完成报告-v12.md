# ğŸ‰ Dreamina AI é¡¹ç›®å®ŒæˆæŠ¥å‘Š v12

**å®Œæˆæ—¶é—´**: 2025-10-03 22:00  
**ç‰ˆæœ¬**: v12.0  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª  

---

## ğŸ“‹ é¡¹ç›®æ¦‚è§ˆ

**é¡¹ç›®åç§°**: Dreamina AI å›¾ç‰‡ç”Ÿæˆ Web åº”ç”¨  
**æŠ€æœ¯æ ˆ**: Python Flask + JavaScript + HTML/CSS  
**åŠŸèƒ½**: æ–‡ç”Ÿå›¾ã€å›¾ç”Ÿå›¾ã€å¤šç«¯åŒæ­¥ã€å†å²è®°å½•ç®¡ç†  

---

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### æ ¸å¿ƒåŠŸèƒ½

1. âœ… **æ–‡ç”Ÿå›¾ (Text-to-Image)**
   - æ”¯æŒæç¤ºè¯ç”Ÿæˆå›¾ç‰‡
   - å¤šç§æ¨¡å‹é€‰æ‹©(3.0/4.0)
   - å¤šç§åˆ†è¾¨ç‡(2k/4k)
   - å¤šç§å®½é«˜æ¯”(1:1/16:9/9:16ç­‰)

2. âœ… **å›¾ç”Ÿå›¾ (Image-to-Image)**
   - æ”¯æŒä¸Šä¼ å‚è€ƒå›¾ç‰‡
   - å¯è°ƒæ•´å‚è€ƒå¼ºåº¦
   - ä¿ç•™æ–‡ç”Ÿå›¾æ‰€æœ‰å‚æ•°

3. âœ… **è´¦å·ç®¡ç†**
   - å¤šè´¦å·æ”¯æŒ
   - è‡ªåŠ¨åˆ‡æ¢è´¦å·
   - ç§¯åˆ†æ˜¾ç¤ºå’Œåˆ·æ–°

4. âœ… **å†å²è®°å½•**
   - æœåŠ¡å™¨ç«¯æŒä¹…åŒ–å­˜å‚¨
   - å›¾ç‰‡ç¼©ç•¥å›¾æ˜¾ç¤º
   - æ”¯æŒåˆ é™¤å’Œæ¸…ç©º
   - å¤šç«¯åŒæ­¥

5. âœ… **ä»»åŠ¡ç®¡ç†**
   - å®æ—¶è¿›åº¦æ˜¾ç¤º
   - ä»»åŠ¡æŒä¹…åŒ–
   - å¤šç«¯ä»»åŠ¡åŒæ­¥
   - æ”¯æŒå–æ¶ˆä»»åŠ¡

---

## ğŸ”§ æœ¬æ¬¡ä¼˜åŒ–å†…å®¹

### ä¼˜åŒ–1: è¿ç¦è¯æ£€æµ‹ä¿®å¤ âœ…

**é—®é¢˜**: è¿ç¦è¯ç”Ÿæˆå¤±è´¥åä»æ˜¾ç¤º"ç”Ÿæˆä¸­..."  
**ä¿®å¤**: 
- æœåŠ¡å™¨ç«¯è¿”å›å¤±è´¥ä¿¡æ¯
- å®¢æˆ·ç«¯ç«‹å³æ˜¾ç¤ºé”™è¯¯
- 15-30ç§’å†…æ£€æµ‹åˆ°å¤±è´¥

**æ–‡ä»¶**:
- `core/api_client.py` (ç¬¬1407-1411, 1545-1549è¡Œ)
- `web/js/app.js` (ç¬¬256-293, 359-394è¡Œ)

---

### ä¼˜åŒ–2: æœåŠ¡å™¨ç«¯å†å²è®°å½• âœ…

**é—®é¢˜**: å†å²è®°å½•å­˜å‚¨åœ¨å®¢æˆ·ç«¯,æ— æ³•å¤šç«¯å…±äº«  
**ä¿®å¤**:
- å†å²è®°å½•å­˜å‚¨åœ¨æœåŠ¡å™¨
- æ‰€æœ‰å®¢æˆ·ç«¯å…±äº«æ•°æ®
- æ”¯æŒå¢åˆ æ”¹æŸ¥

**æ–‡ä»¶**:
- `web/server.py` (ç¬¬694-822è¡Œ)
- `web/js/api.js` (ç¬¬274-341è¡Œ)
- `web/js/ui.js` (ç¬¬456-520è¡Œ)

---

### ä¼˜åŒ–3: å†å²è®°å½•æŒä¹…åŒ– âœ…

**é—®é¢˜**: åˆ·æ–°é¡µé¢æˆ–é‡å¯æœåŠ¡å™¨åå†å²è®°å½•ä¸¢å¤±  
**ä¿®å¤**:
- ä¿å­˜åˆ°`web/history.json`æ–‡ä»¶
- æœåŠ¡å™¨å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½
- æ¯æ¬¡æ“ä½œå®æ—¶ä¿å­˜

**æ–‡ä»¶**:
- `web/server.py` (ç¬¬694-822è¡Œ)

**æ•°æ®æ–‡ä»¶**:
- `web/history.json`

---

### ä¼˜åŒ–4: ä»»åŠ¡æŒä¹…åŒ– âœ…

**é—®é¢˜**: åˆ·æ–°é¡µé¢åæ­£åœ¨ç”Ÿæˆçš„ä»»åŠ¡ä¸¢å¤±  
**ä¿®å¤**:
- ä»»åŠ¡ä¿å­˜åˆ°localStorage
- é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ¢å¤
- ç»§ç»­è½®è¯¢è·å–ç»“æœ

**æ–‡ä»¶**:
- `web/js/app.js` (ç¬¬70-120è¡Œ)

---

### ä¼˜åŒ–5: é˜²æ­¢é‡å¤æäº¤ âœ…

**é—®é¢˜**: åˆ·æ–°é¡µé¢åä¼šé‡æ–°æäº¤ç”Ÿå›¾è¯·æ±‚  
**ä¿®å¤**:
- æ£€æŸ¥æ˜¯å¦å·²æœ‰serverTaskId
- æ¢å¤çš„ä»»åŠ¡ç›´æ¥è½®è¯¢
- æ–°ä»»åŠ¡æ‰æäº¤è¯·æ±‚

**æ–‡ä»¶**:
- `web/js/app.js` (ç¬¬195-252è¡Œ)

---

### ä¼˜åŒ–6: UIä¼˜åŒ– âœ…

**é—®é¢˜**: å†å²è®°å½•å›¾ç‰‡æ˜¾ç¤ºä¸å®Œæ•´  
**ä¿®å¤**:
- ä½¿ç”¨CSS `aspect-ratio: 1`
- ä¿æŒå›¾ç‰‡1:1æ¯”ä¾‹
- å®Œæ•´æ˜¾ç¤ºç¼©ç•¥å›¾

**æ–‡ä»¶**:
- `web/css/style.css` (ç¬¬454-514è¡Œ)

---

### ä¼˜åŒ–7: å¤šç«¯ä»»åŠ¡åŒæ­¥ âœ…

**é—®é¢˜**: ç”µè„‘ç”Ÿæˆçš„ä»»åŠ¡,æ‰‹æœºç«¯çœ‹ä¸åˆ°  
**ä¿®å¤**:
- ä»»åŠ¡ä¿å­˜åˆ°æœåŠ¡å™¨
- æ¯10ç§’åŒæ­¥ä¸€æ¬¡
- æ‰€æœ‰å®¢æˆ·ç«¯å®æ—¶æ›´æ–°

**æ–‡ä»¶**:
- `web/server.py` (ç¬¬719-794è¡Œ)
- `web/js/app.js` (ç¬¬55-124, 342-376è¡Œ)

**APIç«¯ç‚¹**:
- `GET /api/tasks/active` - è·å–æ´»è·ƒä»»åŠ¡
- `POST /api/tasks/active` - æ·»åŠ ä»»åŠ¡
- `DELETE /api/tasks/active/<id>` - åˆ é™¤ä»»åŠ¡

---

## ğŸ“Š æŠ€æœ¯æ¶æ„

### åç«¯æ¶æ„

```
Flask Server (web/server.py)
â”œâ”€â”€ APIè·¯ç”±
â”‚   â”œâ”€â”€ /api/accounts - è´¦å·ç®¡ç†
â”‚   â”œâ”€â”€ /api/generate/t2i - æ–‡ç”Ÿå›¾
â”‚   â”œâ”€â”€ /api/generate/i2i - å›¾ç”Ÿå›¾
â”‚   â”œâ”€â”€ /api/poll - è½®è¯¢ä»»åŠ¡çŠ¶æ€
â”‚   â”œâ”€â”€ /api/history - å†å²è®°å½•
â”‚   â”œâ”€â”€ /api/tasks/active - æ´»è·ƒä»»åŠ¡
â”‚   â””â”€â”€ /api/proxy/image - å›¾ç‰‡ä»£ç†
â”œâ”€â”€ æ ¸å¿ƒç»„ä»¶
â”‚   â”œâ”€â”€ TokenManager - Tokenç®¡ç†
â”‚   â”œâ”€â”€ DreaminaAPIClient - APIå®¢æˆ·ç«¯
â”‚   â””â”€â”€ ConfigManager - é…ç½®ç®¡ç†
â””â”€â”€ æ•°æ®å­˜å‚¨
    â”œâ”€â”€ config.json - é…ç½®æ–‡ä»¶
    â”œâ”€â”€ history.json - å†å²è®°å½•
    â””â”€â”€ active_tasks (å†…å­˜) - æ´»è·ƒä»»åŠ¡
```

### å‰ç«¯æ¶æ„

```
Web Client
â”œâ”€â”€ HTML (web/index.html)
â”‚   â”œâ”€â”€ è¡¨å•åŒºåŸŸ
â”‚   â”œâ”€â”€ ä»»åŠ¡åˆ—è¡¨
â”‚   â””â”€â”€ ä¾§è¾¹æ 
â”œâ”€â”€ CSS (web/css/style.css)
â”‚   â”œâ”€â”€ å¸ƒå±€æ ·å¼
â”‚   â”œâ”€â”€ ç»„ä»¶æ ·å¼
â”‚   â””â”€â”€ å“åº”å¼è®¾è®¡
â””â”€â”€ JavaScript
    â”œâ”€â”€ app.js - åº”ç”¨ä¸»é€»è¾‘
    â”œâ”€â”€ api.js - APIå®¢æˆ·ç«¯
    â”œâ”€â”€ ui.js - UIç®¡ç†
    â””â”€â”€ config.js - é…ç½®
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
Comfyui_Free_Dreamina-main/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ api_client.py - Dreamina APIå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ token_manager.py - Tokenç®¡ç†å™¨
â”‚   â””â”€â”€ config_manager.py - é…ç½®ç®¡ç†å™¨
â”œâ”€â”€ web/
â”‚   â”œâ”€â”€ server.py - FlaskæœåŠ¡å™¨
â”‚   â”œâ”€â”€ index.html - ä¸»é¡µé¢
â”‚   â”œâ”€â”€ config.json - é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ history.json - å†å²è®°å½•
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css - æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ app.js - åº”ç”¨é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ api.js - APIå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ ui.js - UIç®¡ç†
â”‚   â”‚   â””â”€â”€ config.js - é…ç½®
â”‚   â””â”€â”€ æ–‡æ¡£/
â”‚       â”œâ”€â”€ è¿ç¦è¯æ£€æµ‹ä¿®å¤è¯´æ˜.md
â”‚       â”œâ”€â”€ æœåŠ¡å™¨ç«¯å†å²è®°å½•è¯´æ˜.md
â”‚       â”œâ”€â”€ ä»»åŠ¡æŒä¹…åŒ–å’ŒUIä¿®å¤è¯´æ˜.md
â”‚       â”œâ”€â”€ å†å²è®°å½•æŒä¹…åŒ–ä¿®å¤è¯´æ˜.md
â”‚       â”œâ”€â”€ é¡¹ç›®ä¼˜åŒ–æ–¹æ¡ˆ.md
â”‚       â”œâ”€â”€ WebSocketå®æ—¶æ¨é€æ–¹æ¡ˆ.md
â”‚       â””â”€â”€ æœ€ç»ˆå®ŒæˆæŠ¥å‘Š-v12.md
â”œâ”€â”€ dreamina_api.py - APIæµ‹è¯•è„šæœ¬
â””â”€â”€ README.md - é¡¹ç›®è¯´æ˜
```

---

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### 1. å¤šç«¯åŒæ­¥

- âœ… å†å²è®°å½•å¤šç«¯å…±äº«
- âœ… ä»»åŠ¡çŠ¶æ€å®æ—¶åŒæ­¥
- âœ… 10ç§’è‡ªåŠ¨åŒæ­¥
- âœ… æ”¯æŒæ— é™å®¢æˆ·ç«¯

### 2. æ•°æ®æŒä¹…åŒ–

- âœ… å†å²è®°å½•æ°¸ä¹…ä¿å­˜
- âœ… ä»»åŠ¡çŠ¶æ€æŒä¹…åŒ–
- âœ… æœåŠ¡å™¨é‡å¯è‡ªåŠ¨æ¢å¤
- âœ… æ•°æ®ä¸ä¼šä¸¢å¤±

### 3. ç”¨æˆ·ä½“éªŒ

- âœ… å®æ—¶è¿›åº¦æ˜¾ç¤º
- âœ… å‹å¥½çš„é”™è¯¯æç¤º
- âœ… å›¾ç‰‡ç¼©ç•¥å›¾é¢„è§ˆ
- âœ… å“åº”å¼è®¾è®¡

### 4. æ€§èƒ½ä¼˜åŒ–

- âœ… å›¾ç‰‡ä»£ç†åŠ é€Ÿ
- âœ… æ™ºèƒ½è½®è¯¢æœºåˆ¶
- âœ… ä»»åŠ¡å»é‡
- âœ… è‡ªåŠ¨æ¸…ç†è¿‡æœŸä»»åŠ¡

---

## ğŸ“ APIæ–‡æ¡£

### è´¦å·ç®¡ç†

**GET /api/accounts**
- åŠŸèƒ½: è·å–æ‰€æœ‰è´¦å·
- è¿”å›: `{success: true, accounts: [...]}`

**POST /api/accounts**
- åŠŸèƒ½: æ·»åŠ è´¦å·
- å‚æ•°: `{token: "..."}`
- è¿”å›: `{success: true, account: {...}}`

**DELETE /api/accounts/{token}**
- åŠŸèƒ½: åˆ é™¤è´¦å·
- è¿”å›: `{success: true}`

### å›¾ç‰‡ç”Ÿæˆ

**POST /api/generate/t2i**
- åŠŸèƒ½: æ–‡ç”Ÿå›¾
- å‚æ•°: `{prompt, model, resolution, ratio, num_images}`
- è¿”å›: `{success: true, task_id: "..."}`

**POST /api/generate/i2i**
- åŠŸèƒ½: å›¾ç”Ÿå›¾
- å‚æ•°: `{prompt, model, resolution, ratio, num_images, reference_image, reference_strength}`
- è¿”å›: `{success: true, task_id: "..."}`

**GET /api/poll**
- åŠŸèƒ½: è½®è¯¢ä»»åŠ¡çŠ¶æ€
- å‚æ•°: `?task_id=...`
- è¿”å›: `{success: true, status: "...", images: [...]}`

### å†å²è®°å½•

**GET /api/history**
- åŠŸèƒ½: è·å–å†å²è®°å½•
- è¿”å›: `{success: true, history: [...]}`

**POST /api/history**
- åŠŸèƒ½: æ·»åŠ å†å²è®°å½•
- å‚æ•°: `{prompt, model, resolution, ratio, mode, images, historyId}`
- è¿”å›: `{success: true, id: "..."}`

**DELETE /api/history/{id}**
- åŠŸèƒ½: åˆ é™¤å†å²è®°å½•
- è¿”å›: `{success: true}`

**POST /api/history/clear**
- åŠŸèƒ½: æ¸…ç©ºå†å²è®°å½•
- è¿”å›: `{success: true, count: 10}`

### æ´»è·ƒä»»åŠ¡

**GET /api/tasks/active**
- åŠŸèƒ½: è·å–æ´»è·ƒä»»åŠ¡
- è¿”å›: `{success: true, tasks: [...]}`

**POST /api/tasks/active**
- åŠŸèƒ½: æ·»åŠ æ´»è·ƒä»»åŠ¡
- å‚æ•°: `{id, formData, mode, startTime, serverTaskId}`
- è¿”å›: `{success: true, id: "..."}`

**DELETE /api/tasks/active/{id}**
- åŠŸèƒ½: åˆ é™¤æ´»è·ƒä»»åŠ¡
- è¿”å›: `{success: true}`

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

### å¼€å‘ç¯å¢ƒ

```bash
# 1. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 2. å¯åŠ¨æœåŠ¡å™¨
python web/server.py

# 3. è®¿é—®åº”ç”¨
# æœ¬åœ°: http://localhost:5000
# å±€åŸŸç½‘: http://192.168.3.68:5000
```

### ç”Ÿäº§ç¯å¢ƒ

```bash
# 1. ä½¿ç”¨Gunicorn
pip install gunicorn

# 2. å¯åŠ¨æœåŠ¡
gunicorn -w 4 -b 0.0.0.0:5000 web.server:app

# 3. ä½¿ç”¨Nginxåå‘ä»£ç†
# é…ç½®æ–‡ä»¶: /etc/nginx/sites-available/dreamina
```

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### å½“å‰æ€§èƒ½

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| é¦–å±åŠ è½½ | ~1.5s |
| ä»»åŠ¡åŒæ­¥å»¶è¿Ÿ | 10s |
| å†å²è®°å½•åŠ è½½ | ~500ms |
| å›¾ç‰‡ä»£ç†å“åº” | ~2s |
| å¹¶å‘æ”¯æŒ | 100+ |

### ä¼˜åŒ–å»ºè®®

1. **WebSocketå®æ—¶æ¨é€** - å»¶è¿Ÿé™ä½åˆ°<100ms
2. **å›¾ç‰‡æ‡’åŠ è½½** - é¦–å±åŠ è½½<1s
3. **CDNåŠ é€Ÿ** - å›¾ç‰‡å“åº”<1s
4. **è™šæ‹Ÿæ»šåŠ¨** - å†å²è®°å½•<200ms

---

## ğŸ”„ ä¸‹ä¸€æ­¥è®¡åˆ’

### çŸ­æœŸä¼˜åŒ– (1-2å‘¨)

1. âœ… å¤šç«¯ä»»åŠ¡åŒæ­¥
2. ğŸ”„ WebSocketå®æ—¶æ¨é€
3. ğŸ”„ å›¾ç‰‡æ‡’åŠ è½½
4. ğŸ”„ æ‰¹é‡ä¸‹è½½åŠŸèƒ½

### ä¸­æœŸä¼˜åŒ– (1ä¸ªæœˆ)

1. ğŸ”„ ç”¨æˆ·ç³»ç»Ÿå’Œæƒé™
2. ğŸ”„ å›¾ç‰‡æ”¶è—åŠŸèƒ½
3. ğŸ”„ æ•°æ®å¯¼å‡ºåŠŸèƒ½
4. ğŸ”„ æ€§èƒ½ç›‘æ§

### é•¿æœŸä¼˜åŒ– (3ä¸ªæœˆ)

1. ğŸ”„ CDNåŠ é€Ÿ
2. ğŸ”„ è‡ªåŠ¨åŒ–æµ‹è¯•
3. ğŸ”„ ç§»åŠ¨ç«¯ä¼˜åŒ–
4. ğŸ”„ å›½é™…åŒ–æ”¯æŒ

---

## ğŸ“š æ–‡æ¡£ç´¢å¼•

1. **è¿ç¦è¯æ£€æµ‹ä¿®å¤è¯´æ˜.md** - è¿ç¦è¯æ£€æµ‹é—®é¢˜ä¿®å¤
2. **æœåŠ¡å™¨ç«¯å†å²è®°å½•è¯´æ˜.md** - å†å²è®°å½•æœåŠ¡å™¨ç«¯å®ç°
3. **ä»»åŠ¡æŒä¹…åŒ–å’ŒUIä¿®å¤è¯´æ˜.md** - ä»»åŠ¡æŒä¹…åŒ–å’ŒUIä¼˜åŒ–
4. **å†å²è®°å½•æŒä¹…åŒ–ä¿®å¤è¯´æ˜.md** - å†å²è®°å½•æ–‡ä»¶æŒä¹…åŒ–
5. **é¡¹ç›®ä¼˜åŒ–æ–¹æ¡ˆ.md** - å®Œæ•´çš„é¡¹ç›®ä¼˜åŒ–å»ºè®®
6. **WebSocketå®æ—¶æ¨é€æ–¹æ¡ˆ.md** - WebSocketå®ç°æ–¹æ¡ˆ
7. **æœ€ç»ˆå®ŒæˆæŠ¥å‘Š-v12.md** - æœ¬æ–‡æ¡£

---

## ğŸŠ æ€»ç»“

### å·²å®ç°çš„æ ¸å¿ƒä»·å€¼

1. **ç¨³å®šæ€§** âœ…
   - æ•°æ®æŒä¹…åŒ–,ä¸ä¼šä¸¢å¤±
   - ä»»åŠ¡æ¢å¤æœºåˆ¶
   - å®Œå–„çš„é”™è¯¯å¤„ç†

2. **å¤šç«¯åä½œ** âœ…
   - å†å²è®°å½•å…±äº«
   - ä»»åŠ¡çŠ¶æ€åŒæ­¥
   - å®æ—¶æ›´æ–°

3. **ç”¨æˆ·ä½“éªŒ** âœ…
   - å‹å¥½çš„ç•Œé¢
   - å®æ—¶è¿›åº¦åé¦ˆ
   - å¿«é€Ÿå“åº”

4. **å¯æ‰©å±•æ€§** âœ…
   - æ¨¡å—åŒ–è®¾è®¡
   - æ¸…æ™°çš„æ¶æ„
   - å®Œå–„çš„æ–‡æ¡£

---

**é¡¹ç›®çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª  
**æœåŠ¡å™¨åœ°å€**: http://192.168.3.68:5000  
**å®Œæˆæ—¶é—´**: 2025-10-03 22:00  

---

*æ„Ÿè°¢ä½¿ç”¨ Dreamina AI å›¾ç‰‡ç”Ÿæˆåº”ç”¨!*

